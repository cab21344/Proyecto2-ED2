// Electrónica Digital 2 - Proyecto 2
// María Daniela Cabrera Porras, 21344

// Librerías ******************************************
#include <Arduino.h>
#include <SPI.h>
//*****************************************************

// Pines display **************************************
#define ecgPin 35
#define tivaPin 5
//******************************************************

// Variables *******************************************
int latidos = 0;
//******************************************************

void setup()
{
  // start the serial connection
  Serial.begin(115200);
  // wait for serial monitor to open
  while (!Serial);
  Serial.print("Connecting...");

  // Configurar entradas y salidas ***********************
  pinMode(ecgPin, INPUT);
  pinMode(tivaPin, OUTPUT);
  //*******************************************************

  SPI.begin(tivaPin);
  SPI.setBitOrder(MSBFIRST);
  SPI.setDataMode(SPI_MODE0);
  SPI.setClockDivider(SPI_CLOCK_DIV16);

  int latidos = digitalRead(ecgPin);
  SPI.transfer(&latidos, sizeof(latidos));
}
void loop()
{
  Serial.print("Ritmo cardaico: ");
  Serial.println(latidos); //imprime la lectura del sensor cardiaco
  delay(1000);
}

int lecturaCorazon(){ //lectura del sensor ritmo cardiaco
  digitalWrite(tivaPin, LOW);
  SPI.transfer(1);
  delay(10);
  int latidos = SPI.transfer(0);
  digitalWrite(tivaPin, HIGH);

  return latidos;
}
